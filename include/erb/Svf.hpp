/*****************************************************************************

      Svf.hpp
      Copyright (c) 2023 Raphael DINGE

*Tab=3***********************************************************************/



#pragma once



/*\\\ INCLUDE FILES \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*/



namespace erb
{



/*\\\ PUBLIC \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*/

/*
==============================================================================
Name: ctor
==============================================================================
*/

Svf::Svf (size_t sample_rate)
{
   _impl.Init (float (sample_rate));
}


/*
==============================================================================
Name: operator ()
==============================================================================
*/

Svf::OutputSample Svf::operator () (float x)
{
   _impl.Process (x);
   return {
      _impl.Low (),
      _impl.High (),
      _impl.Band (),
      _impl.Notch (),
      _impl.Peak (),
   };
}



/*
==============================================================================
Name: operator ()
==============================================================================
*/

template <size_t size>
Svf::OutputBuffer <size>   Svf::operator () (std::array <float, size> in)
{
   OutputBuffer <size> ret;

   for (size_t i = 0 ; i < size ; ++i)
   {
      _impl.Process (in [i]);
      ret.low [i] = _impl.Low ();
      ret.high [i] = _impl.High ();
      ret.band[i] = _impl.Band ();
      ret.notch [i] = _impl.Notch ();
      ret.peak [i] = _impl.Peak ();
   }

   return ret;
}



/*\\\ INTERNAL \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*/

/*
==============================================================================
Name: impl_set_frequency
==============================================================================
*/

void  Svf::impl_set_frequency (float freq)
{
   _impl.SetFreq (freq);
}



/*
==============================================================================
Name: impl_set_frequency
==============================================================================
*/

void  Svf::impl_set_frequency (Frequency freq)
{
   _impl.SetFreq (freq.value);
}



/*
==============================================================================
Name: impl_set_resonance
==============================================================================
*/

void  Svf::impl_set_resonance (float res)
{
   _impl.SetRes (res);
}



/*
==============================================================================
Name: impl_set_drive
==============================================================================
*/

void  Svf::impl_set_drive (float drive)
{
   _impl.SetDrive (drive);
}



/*\\\ PRIVATE \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*/



}  // namespace erb



/*\\\ EOF \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\*/
